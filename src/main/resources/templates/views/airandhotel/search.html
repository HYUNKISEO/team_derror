<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Country Information Search</title>
</head>
<body>
<h1>Country Information Search</h1>

<label for="countryName">Enter Country Name:</label>
<input type="text" id="countryName" name="countryName" required>
<button onclick="searchCountry()">Search</button>

<table id="resultTable">
  <thead>
  <tr>
    <th>국가 이름</th>
    <th>공항 이름</th>
    <th>공항 코드</th>
  </tr>
  </thead>
  <tbody id="resultBody"></tbody>
</table>

<script>
  function searchCountry() {
    var countryName = document.getElementById("countryName").value;

    // API 호출
    fetch(`/api/air/code`)
            .then(response => response.json())
            .then(data => {
              // "네덜란드"를 포함하는 데이터만 필터링
              var countryList = data.response.body.items || [];
              var filteredData = countryList.filter(country => country.countryName.includes(countryName));

              // 결과를 표에 표시
              displayResults(filteredData);
            })
            .catch(error => {
              console.error('Error:', error);
              document.getElementById("resultBody").innerHTML = '<tr><td colspan="3">Error occurred while fetching data.</td></tr>';
            });
  }

  function displayResults(data) {
    var resultHtml = '';
    data.forEach(country => {
      resultHtml += `<tr>
          <td>${country.countryName}</td>
          <td>${country.airportName}</td>
          <td>${country.airportCode}</td>
        </tr>`;
    });
    document.getElementById("resultBody").innerHTML = resultHtml;
  }
</script>
</body>
</html>